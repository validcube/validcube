
name: ðŸ‘· Update Contribution Metrics
on:
  schedule: [{cron: "0 0 * * *"}]
  workflow_dispatch:
  push: {branches: ["main"]}
jobs:
  github-actions:
    name: ðŸª¸ Update Contribution Metrics - GitHub Actions
    runs-on: ubuntu-latest
    timeout-minutes: 20
    steps:
    - name: Activity
      uses: lowlighter/metrics@latest
      with:
        filename: metrics.classic.svg
        token: ${{ secrets.METRICS_TOKEN }}
        base: ""
        plugin_habits: yes
        plugin_habits_facts: yes
        plugin_habits_charts: yes
        config_timezone: Asia/Bangkok
        plugin_languages: yes
        plugin_languages_indepth: yes
        plugin_languages_details: lines, bytes-size
  self-hosted:
    name: ðŸª¸ Update Contribution Metrics - Self-hosted
    runs-on: [self-hosted, linux, low-power]
    timeout-minutes: 20
    if: ${{ failure() }}
    needs: github-actions
    steps:
    - name: Activity
      uses: lowlighter/metrics@latest
      with:
        filename: metrics.classic.svg
        token: ${{ secrets.METRICS_TOKEN }}
        base: ""
        plugin_habits: yes
        plugin_habits_facts: yes
        plugin_habits_charts: yes
        config_timezone: Asia/Bangkok
        plugin_languages: yes
        plugin_languages_indepth: yes
        plugin_languages_details: lines, bytes-size
